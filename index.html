<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	
	<!-- blockly resources: [harrison] -->
	<!-- https://developers.google.com/blockly/guides/get-started/web -->
	<!-- https://developers.google.com/blockly/guides/app-integration/running-javascript -->
	<!-- https://developers.google.com/blockly/guides/configure/web/fixed-size -->
	
	<!-- block categories -->
	<!-- https://developers.google.com/blockly/guides/configure/web/toolbox#block_groups -->
	
	<!-- blockly demo with list of block types (originally had to compile this myself) -->
	<!-- https://blockly-demo.appspot.com/static/demos/blockfactory/index.html -->
	
	<!-- custom blocks -->
	<!-- https://developers.google.com/blockly/guides/create-custom-blocks/define-blocks -->
	<!-- https://developers.google.com/blockly/guides/create-custom-blocks/generating-code -->
	<!-- https://blockly-demo.appspot.com/static/demos/blockfactory/index.html -->
	
	<!-- blockly core -->
	<script src="blockly/blockly_compressed.js"></script>
	<script src="blockly/blocks_compressed.js"></script>
	
	<script src="blockly/javascript_compressed.js"></script>
	
	<!-- messages for user's language -->
	<script src="blockly/msg/js/en.js"></script>
	
	<!-- jquery, bootstrap -->
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
	<!-- override bootstrap with my own css -->
	<link rel="stylesheet" href="css/styles.css">

	<!-- disable mobile zoom before iOS 10 -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	
	<!-- code to generate js from blockly -->
	<script type="text/javascript" src="js/generate.js"></script>
	
	<script type="text/javascript">
	
	function initialize() {
		$('#myModal').on('shown.bs.modal', function (e) {
		  /* workaround for Blockly to render within Bootstrap modal */
		  window.dispatchEvent(new Event('resize'));
		});
	}
	
	function runCodeClicked() {
		try {
			var code = Blockly.JavaScript.workspaceToCode(workspace);
			alert("code: " + code);
			
		 	eval(code);
		} catch (e) {
		  alert(e);
		}
	}
	
	</script>
	
	<!-- custom blocks -->
	
	<script type="text/javascript" src="blockly-custom/blocks/game.js"></script>
	<script type="text/javascript" src="blockly-custom/generators/game.js"></script>
	
	<!-- game engine -->
	
	<script type="text/javascript" src="phaser/build/phaser.min.js"></script>
	
</head>
<body onload="initialize()">
	
	<div class="container">
		<div class="row">
			<button type="button" class="btn btn-primary btn-large" data-toggle="modal" data-target="#myModal">Show Code Terminal</button>
		</div>
		
		<div class="row">
				<!-- Modal -->
				<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="codeTerminalLabel" aria-hidden="true">
			        <div class="modal-dialog" style="width: 60%; height: 80%;" id="thing2">
			            <div class="modal-content">
			                <div class="modal-header">
			                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			                    <h4 class="modal-title" id="codeTerminalLabel">Code Terminal</h4>
			                </div>
			                <div class="modal-body">
			                	
			                		<!-- blockly div -->
			                		<div id="blocklyDiv"></div>
			                		
			                		<!-- blockly toolbox -->
			                		<xml id="toolbox">
			                			
			                			<!-- divided by category file name -->
			                			
			                			<category name="Game" colour="20">
			                		    	<block type="move_character"></block>
			                		    	<block type="character_jump"></block>
			                		    </category>
			                			
			                			<category name="Colors" colour="20">
			                		    	<block type="colour_picker"></block>
			                		    	<block type="colour_rgb"></block>
			                		    	<block type="colour_blend"></block>
			                		    </category>
			                		    
			                		    <category name="Lists" colour="20">
			                		    	<block type="lists_create_empty"></block>
			                		    	<block type="lists_repeat"></block>
			                		    	<block type="lists_reverse"></block>
			                		    	<block type="lists_isEmpty"></block>
			                		    	<block type="lists_length"></block>
			                		    	<block type="lists_create_with"></block>
			                		    	<block type="lists_create_with_container"></block>
			                		    	<block type="lists_create_with_item"></block>
			                		    	<block type="lists_indexOf"></block>
			                		    	<block type="lists_getIndex"></block>
			                		    	<block type="lists_setIndex"></block>
			                		    	<block type="lists_sort"></block>
			                		    	<block type="lists_split"></block>
			                		    </category>
			                		    
			                		 	<category name="Logic" colour="210">
			                		 		<block type="logic_boolean"></block>
			                		 		<block type="logic_compare"></block>
			                		 		<block type="logic_operation"></block>
			                		 		<block type="logic_negate"></block>
			                		 		<block type="logic_null"></block>
			                		 		<block type="logic_ternary"></block>
			                		 		
			                		 		<block type="controls_if"></block>
			                		 		<block type="controls_ifelse"></block>
			                		 		<block type="controls_if_if"></block>
			                		 		<block type="controls_if_elseif"></block>
			                		 		<block type="controls_if_else"></block>
			                		 	</category>
			                		 	
			                		    <category name="Loops" colour="120">
			                		    	<block type="controls_repeat_ext"></block>
			                	    	    <block type="controls_repeat"></block>
			                				<block type="controls_whileUntil"></block>
			                				<block type="controls_for"></block>
			                				<block type="controls_forEach"></block>
			                				<block type="controls_flow_statements"></block>
			                		    </category>
			                		    
			                		    <category name="Math" colour="230">
			                		    	<block type="math_number"></block>
			                		    	<block type="math_arithmetic"></block>
			                		    	<block type="math_single"></block>
			                		    	<block type="math_trig"></block>
			                		    	<block type="math_constant"></block>
			                		    	<block type="math_number_property"></block>
			                		    	<block type="math_change"></block>
			                		    	<block type="math_round"></block>
			                		    	<block type="math_on_list"></block>
			                		    	<block type="math_modulo"></block>
			                		    	<block type="math_constrain"></block>
			                		    	<block type="math_random_int"></block>
			                		    	<block type="math_random_float"></block>
			                		    </category>
			                		    
			                		    <category name="Text" colour="20">
			                		    	<block type="text"></block>
			                		    	<block type="text_join"></block>
			                		    	<block type="text_create_join_container"></block>
			                		    	<block type="text_create_join_item"></block>
			                		    	<block type="text_append"></block>
			                		    	<block type="text_length"></block>
			                		    	<block type="text_isEmpty"></block>
			                		    	<block type="text_indexOf"></block>
			                		    	<block type="text_charAt"></block>
			                		    </category>
			                		    
			                		    
			                		    <!-- skipped procedures.js and variables.js -->
			                		    
			                		    <category name="Output" colour="20">
			                		    	<block type="text"></block>
			                		    	<block type="text_print"></block>
			                		    </category>
			                		    
			                		    <category name="Variables" colour="330" custom="VARIABLE"></category>
			                		    <category name="Functions" colour="290" custom="PROCEDURE"></category>
			                		</xml>
			                	
			                </div>
			                <div class="modal-footer">
			                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			                    <button type="button" class="btn btn-primary" onclick="runCodeClicked()">Run Code</button>
			                </div>
			            </div>
			        </div>
			    </div>
		</div>
		
		<div class="row">
			<div id="game" class="overlay"></div>
	      	<div id="orientation"></div>
		</div>
	
	</div>
	
	<!-- inject blockly into above div -->
	<script>
	  var workspace = Blockly.inject('blocklyDiv', {toolbox: document.getElementById('toolbox')} );
	</script>
	
	<!-- inject game engine into above div -->
    <script type="text/javascript" src="game/game.js"></script>
    
</body>


</html>
